<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>多项式全家桶 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="目前只有一些偏简单常用的部分。   多项式的逆元是一对	乘积为乘法单位元的多项式。乘法单位元显然是 $F(x)&#x3D;1$。  对于多项式 $F(x)$，$\ln F(x)&#x3D;G(x)$ 是指 $e^{G(x)}&#x3D;F(x)$。   $e^{G(x)}$ 是一个多项式（幂级数）（的封闭形式）！对 $e^{G(x)}$ 进行麦克劳林展开得到它的幂级数（多项式）：$$e^{G(x)">
<meta property="og:type" content="article">
<meta property="og:title" content="多项式全家桶">
<meta property="og:url" content="https://2008verser.github.io/2024/07/30/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%85%A8%E5%AE%B6%E6%A1%B6/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="目前只有一些偏简单常用的部分。   多项式的逆元是一对	乘积为乘法单位元的多项式。乘法单位元显然是 $F(x)&#x3D;1$。  对于多项式 $F(x)$，$\ln F(x)&#x3D;G(x)$ 是指 $e^{G(x)}&#x3D;F(x)$。   $e^{G(x)}$ 是一个多项式（幂级数）（的封闭形式）！对 $e^{G(x)}$ 进行麦克劳林展开得到它的幂级数（多项式）：$$e^{G(x)">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-07-30T11:32:27.000Z">
<meta property="article:modified_time" content="2024-07-30T12:04:12.000Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="多项式">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://2008verser.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-多项式全家桶" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/07/30/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%85%A8%E5%AE%B6%E6%A1%B6/" class="article-date">
  <time class="dt-published" datetime="2024-07-30T11:32:27.000Z" itemprop="datePublished">2024-07-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      多项式全家桶
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>目前只有一些偏简单常用的部分。</p>
<hr>
<ul>
<li><p>多项式的逆元是一对	乘积为乘法单位元的多项式。乘法单位元显然是 $F(x)&#x3D;1$。</p>
</li>
<li><p>对于多项式 $F(x)$，$\ln F(x)&#x3D;G(x)$ 是指 $e^{G(x)}&#x3D;F(x)$。</p>
</li>
</ul>
<p>$e^{G(x)}$ 是一个多项式（幂级数）（的封闭形式）！对 $e^{G(x)}$ 进行麦克劳林展开得到它的幂级数（多项式）：<br>$$<br>e^{G(x)}&#x3D;\sum_{n\geq 0}\frac{G(x)^n}{n!}<br>$$</p>
<ul>
<li>多项式 $\exp$ 的定义如上。</li>
<li>多项式求导、积分与普通函数相同。</li>
</ul>
<hr>
<h2 id="多项式乘法（FFT-NTT）"><a href="#多项式乘法（FFT-NTT）" class="headerlink" title="多项式乘法（FFT&amp;NTT）"></a>多项式乘法（FFT&amp;NTT）</h2><ul>
<li>FFT</li>
</ul>
<p>求出 $F(x)$ 和 $G(x)$ 在 $\omega_{n}^0,\omega_{n}^1,…\omega_{n}^{n-1}$ 处的点值，相乘，再插值。</p>
<p>求点值（DFT）：将多项式系数按次数奇偶分开求点值，利用单位根性质划分为两个规模为一半的相同子问题。分治求解。</p>
<p>插值（IDFT）：单位根反演后，左侧是 $n$ 乘上 $i$ 次项系数，右侧是把求出的点值当作系数成为一个多项式，求 $\omega_{n}^{-i}$ 的点值的式子。套用 DFT 求解。</p>
<p>FFT 是在复数上的实现，在代码中使用浮点数。</p>
<ul>
<li>NTT</li>
</ul>
<p>设 $g$ 是质数 $p$ 的原根之一。</p>
<p>将 $g^{0},g^{(p-1)&#x2F;n},g^{2(p-1)&#x2F;n},…,g^{(n-1)(p-1)&#x2F;n}$ 替换掉单位根。</p>
<p>可以完成多项式乘法在数论上的实现。</p>
<hr>
<h2 id="多项式求逆"><a href="#多项式求逆" class="headerlink" title="多项式求逆"></a>多项式求逆</h2><p>给出 $F(x)$，要求 $G(x)$ 满足 $G(x)F(x)\equiv1\pmod{x^n}$。</p>
<p>设 $R_0(x)F(x)\equiv1\pmod{x^{n&#x2F;2}},R(x)F(x)\equiv1\pmod{x^n}$。</p>
<p>假设已知 $R_0(x)$，试求 $R(x)$。</p>
<p>因为 $R(x)F(x)$ 在模 $x^{n&#x2F;2}$ 意义下也是 $1$。所以有 $R_0(x)\equiv R(x)\pmod{x^{n&#x2F;2}}$。</p>
<p>相减后做平方，则模数就升到 $x^n$，两侧再同时乘以 $F(x)$ 消去两个 $R(x)$，得到递推式。<br>$$<br>\begin{aligned}<br>R_0(x)^2-2R(x)R_0(x)+R(x)^2&amp;\equiv0\pmod{x^n}\<br>R_0(x)^2F(x)-2R_0(x)+R(x)&amp;\equiv0\pmod{x^n}\<br>R(x)&amp;\equiv 2R_0(x)-R_0(x)^2F(x)\pmod{x^n}<br>\end{aligned}<br>$$<br>先把次数补到 $2$ 的整幂再倍增即可。</p>
<p>边界即一个整数求逆。</p>
<p>时间复杂度 $T(n)&#x3D;T(n&#x2F;2)+O(n\log n)&#x3D;O(n\log n)$。</p>
<hr>
<h2 id="多项式对数函数（取-ln-）（含求导、积分）"><a href="#多项式对数函数（取-ln-）（含求导、积分）" class="headerlink" title="多项式对数函数（取 $\ln$）（含求导、积分）"></a>多项式对数函数（取 $\ln$）（含求导、积分）</h2><p>给出 $F(x)$，要求 $n$ 次多项式 $G(x)$ 满足 $G(x)&#x3D;\ln F(x)$。</p>
<p>设 $f(x)&#x3D;\ln x$。则题目变成了复合函数 $G(x)&#x3D;f(F(x))$。</p>
<p>先导再积。</p>
<p>复合函数求导为：$f(g(x))’&#x3D;f’(g(x))g’(x)$。</p>
<p>结合 $(\ln x)’&#x3D;\frac{1}{x}$ 可以化简。<br>$$<br>G’(x)&#x3D;f(F(x))’&#x3D;f’(F(x))F’(x)&#x3D;\frac{F’(x)}{F(x)}<br>$$</p>
<p>$$<br>G(x)&#x3D;\int G’(x)dx<br>$$</p>
<p>就差求导和积分了。</p>
<p>它俩满足：</p>
<p>【多个单项式的和】的导数（积分）等于【多个单项式的导数（积分）】的和。</p>
<p>【系数乘未知数】的导数（积分）等于系数乘【未知数的导数（积分）】。</p>
<p>利用<br>$$<br>(x^a)’&#x3D;ax^{a-1},\int x^{a}dx&#x3D;\frac{1}{a+1}x^{a+1}<br>$$<br>可以 $O(n)$ 求出给定多项式的导数和积分。</p>
<p>综上，求 $\ln$ 时间显然 $O(n\log n)$。</p>
<hr>
<h2 id="多项式牛顿迭代"><a href="#多项式牛顿迭代" class="headerlink" title="多项式牛顿迭代"></a>多项式牛顿迭代</h2><p>若已知 $g(x)$，且有 $g(f(x))&#x3D;0$，可以倍增求得 $f$。</p>
<p>设 $f_0(x)$ 满足在模 $x^{n&#x2F;2}$ 意义下 $g(f_0(x))&#x3D;0$。</p>
<p>求在模 $x^n$ 意义下的 $f$ 有如下公式：<br>$$<br>f(x)&#x3D;f_0(x)-\frac{g(f_0(x))}{g’(f_0(x))}<br>$$<br>通过手动构造不同的 $g$，可以很简单地求出一些 $f$。如多项式求逆。</p>
<p>证明：鸽鸽鸽鸽鸽。（我只挑难的鸽！）看看今年能不能补上。</p>
<hr>
<h2 id="多项式指数函数（取-exp-）"><a href="#多项式指数函数（取-exp-）" class="headerlink" title="多项式指数函数（取 $\exp$）"></a>多项式指数函数（取 $\exp$）</h2><p>给定 $n-1$ 次多项式 $F(x)$，求 $e^{F(x)}$ 在模 $x^n$ 意义下值。（满足 $[x^0]F(x)&#x3D;0$）</p>
<p>直接构造使得 $g(e^{F(x)})&#x3D;0$ 的 $g(x)&#x3D;\ln x-F(x)$。</p>
<p>$g’(x)&#x3D;(\ln x)’-(F(x))’&#x3D;\frac{1}{x}$。</p>
<p>设倍增的多项为 $h(x)$，套公式即可：<br>$$<br>h(x)&#x3D;h_0(x)-\frac{g(h_0(x))}{g’(h_0(x))}&#x3D;h_0(x)-\frac{\ln h_0(x)-F(x)}{\frac{1}{h_0(x)}}&#x3D;h_0(x)(1-\ln h_0(x)+F(x))<br>$$<br>初始值是 $e^{F(x)}\bmod x&#x3D;\sum_{n\geq 0}\frac{F(x)^n}{n!}\bmod x$，因为 $F(x)^n$ 大于零次项全都模掉了，而 $a_0$ 又是零，</p>
<p>所以仅当 $n&#x3D;0$ 时有 $1$ 的贡献。初始值是 $1$。</p>
<ul>
<li>如果不保证 $a_0&#x3D;0$？</li>
</ul>
<p>设 $f_i&#x3D;[x^i]F(x)$，初值就是<br>$$<br>\sum_{n\geq 0}\frac{f_0^n}{n!}&#x3D;e^{f_0}<br>$$<br>而 $e$ 在模意义下无意义。这是算不了的。吧？（应该没有什么还不懂的东西能算这个了吧……如果有请教我）</p>
<p>（$e$ 在模意义下无意义，是因为它等于 $\sum_{n\geq 0}\frac{1}{n!}\bmod p$，分母迟早要模成零，出现除以零错误 ×）</p>
<p>写代码的时候需要注意，$\ln h_0(x)$ 需要在模 $x^n$ 的意义下求，$\ln$ 里面套的那个求逆也要求在 $x^n$ 意义下的！！！</p>
<p>写 <code>vector</code> 尤其容易写错，还难调。（我就傻了好久）</p>
<hr>
<h2 id="多项式开根"><a href="#多项式开根" class="headerlink" title="多项式开根"></a>多项式开根</h2><p>给定 $F(x)$，求 $G(x)$ 满足 $G(x)^2\equiv F(x)\pmod{x^n}$。要求零次项系数最小。$[x^0]F(x)&#x3D;1$。</p>
<p>类似上一道题，零次项系数保证的是倍增初值是 $1$。</p>
<p>直接多项式牛顿迭代：<br>$$<br>g(x)&#x3D;x^2-F(x)<br>$$</p>
<p>$$<br>h(x)&#x3D;\frac{h_0(x)^2+F(x)}{2h_0(x)}<br>$$</p>
<p>继续注意分母的精度即可。</p>
<hr>
<h2 id="下降幂多项式乘法"><a href="#下降幂多项式乘法" class="headerlink" title="下降幂多项式乘法"></a>下降幂多项式乘法</h2><p>给出两个下降幂多项式，求它们乘积的多项式的下降幂表示。</p>
<p>直接用下降幂和连续点值的相互转换做就好了。</p>
<p>具体地，求出多项式的连续点值，然后相乘，然后插值。</p>
<p>求点值是：（直接把解析式化成卷积形式）<br>$$<br>\frac{f(x)}{x!}&#x3D;\sum_{i&#x3D;0}^xa_i\frac{1}{(x-i)!}<br>$$<br>插值是：（把解析式化出一个组合数然后二项式反演，再化成卷积形式）<br>$$<br>a_x&#x3D;\sum_{i&#x3D;0}^x\frac{f(i)}{i!}\frac{(-1)^{x-i}}{(x-i)!}<br>$$</p>
<hr>
<h2 id="多项式快速幂"><a href="#多项式快速幂" class="headerlink" title="多项式快速幂"></a>多项式快速幂</h2><p>法一：快速幂。$O(n\log n\log k)$。</p>
<p>法二：$F(x)^k&#x3D;(e^{\ln F(x)})^k&#x3D;e^{k\ln F(x)}$。$O(n\log n+n\log(k\bmod 998244353))$。</p>
<p>两种方法的指数都是可以取模的。下面证明抄的<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/solution/P5245">【这里】</a>：</p>
<p>设 $p$ 为一个质数模数，当计算 $f(x)^p\bmod x^n$ 时，根据 $(a+b)^n\equiv a^n+b^n\pmod{x^n}$，</p>
<p>把每个单项式取 $p$ 次方，又因为 $p$ 大于 $n$，所以只有零次项没被模掉，所以 $f(x)^p\bmod x^n&#x3D;a_0^p&#x3D;1$。</p>
<p>故可以将次数取模。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://2008verser.github.io/2024/07/30/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%85%A8%E5%AE%B6%E6%A1%B6/" data-id="cm3l49jgd000138fe1zw9ffy0" data-title="多项式全家桶" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/" rel="tag">多项式</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2024/07/30/%E7%BA%BF%E6%80%A7%E5%9F%BA/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          线性基
        
      </div>
    </a>
  
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%80%BB%E7%BB%93/">总结</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/" rel="tag">多项式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%82%E6%88%96/" rel="tag">异或</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%BB%E7%BB%93/" rel="tag">总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E7%9B%B8%E5%85%B3/" rel="tag">线性相关</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/" style="font-size: 10px;">多项式</a> <a href="/tags/%E5%BC%82%E6%88%96/" style="font-size: 10px;">异或</a> <a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 15px;">总结</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E7%9B%B8%E5%85%B3/" style="font-size: 10px;">线性相关</a> <a href="/tags/%E9%A2%98%E8%A7%A3/" style="font-size: 20px;">题解</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/07/30/%E6%80%BB%E7%BB%9310/">总结10</a>
          </li>
        
          <li>
            <a href="/2024/07/30/%E6%80%BB%E7%BB%9311/">总结11</a>
          </li>
        
          <li>
            <a href="/2024/07/30/%E6%80%BB%E7%BB%931/">总结1</a>
          </li>
        
          <li>
            <a href="/2024/07/30/%E6%9D%82%E9%A2%981/">杂题1</a>
          </li>
        
          <li>
            <a href="/2024/07/30/%E7%BA%BF%E6%80%A7%E5%9F%BA/">线性基</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>